+function(window){window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame;window.d=window.d instanceof Date?window.d:new Date;var ua=navigator.userAgent;var protocol=window.location.protocol;var data={u:window.location.href,s:window.screen.width+"x"+window.screen.height,f:0,l:0,t:0,o:0,r:0,a:9,e:window.elk||""};var cookieArr=document.cookie.match(new RegExp("(^| )deviceType=([^;]*)(;|$)"));if(cookieArr){data.a=+cookieArr[2]}if(window.localStorage&&window.localStorage.getItem("deviceType"))data.a=+window.localStorage.getItem("deviceType");if(/ipad/gi.test(ua)){data.a=3}if(!/ipad|iphone|ipod|android|windows phone/gi.test(ua)){data.a=4}if(protocol=="https:"){data.a=+data.a+10}var fpsRecordLimit=20;var startTime=new Date;var frames=0;var fpsCount=0;var d=new Date;function record(){if(window.requestAnimationFrame){window.requestAnimationFrame(function(){frames++;var dd=new Date;if(dd-d>1e3){var fpsResult=fpsCount*1e3/(dd-d);if(/fps/i.test(window.location.href))showFps(fpsResult);if(fpsResult<data.l||data.l==0){data.l=fpsResult>>0;data.t=document.body.scrollTop||document.documentElement.scrollTop||0}d=dd;fpsCount=0}fpsCount++;record()})}}function showFps(fps){var fpsBox=document.getElementById("FPS");if(!fpsBox){fpsBox=document.createElement("div");fpsBox.style.cssText="position:fixed;right:0px;top:0px;font-size:12px;color:#fff;background-color:#666;";fpsBox.id="FPS";document.body.appendChild(fpsBox)}fpsBox.innerHTML=fps}function addEvent(el,type,handle){if(el.addEventListener){el.addEventListener(type,handle,false)}else{el.attachEvent("on"+type,handle)}}function isLowerBrowser(){var result=/msie\s+([\w\.]+)/i.exec(navigator.userAgent);if(result&&parseInt(result[1])<=9){return true}return false}function jsonp(url){var oHead=document.getElementsByTagName("head")[0];var oS=document.createElement("script");var removed=false;oS.async="async";oHead.insertBefore(oS,oHead.firstChild);oS.onload=oS.onreadystatechange=function(){if(!removed&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){oHead.removeChild(oS);removed=true}};oS.src=url}addEvent(window,"load",function(){data.o=new Date-window.d});var posted=false;var postData=function(async){if(posted)return;posted=true;data.f=frames*1e3/(new Date-startTime)>>0;var xhr=new XMLHttpRequest;var params=[];for(var i in data){params.push(i+"="+encodeURIComponent(data[i]))}params=params.join("&");if(isLowerBrowser()){return jsonp(protocol+"//api.tuniu.com/stat/save?"+params)}xhr.open("get",protocol+"//api.tuniu.com/stat/save?"+params,async||false);xhr.send(null)};addEvent(window,"beforeunload",postData);addEvent(window,"unload",postData);setTimeout(function(){postData(true)},1e4);window.PERFORMANCE=data;record()}(window);